apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
spec:
  acme:
    # Production ACME server
    server: https://acme-v02.api.letsencrypt.org/directory
    email: admin@hugecat.net  # Change this to your email
    privateKeySecretRef:
      name: letsencrypt-prod
    solvers:
    # Use Azure DNS for DNS-01 challenge (recommended for Azure)
    - dns01:
        azureDNS:
          # Azure DNS Zone configuration
          # Note: Requires service principal or managed identity with DNS Zone Contributor role
          subscriptionID: 79307c77-54c3-4738-be2a-dc96da7464d9  # Update this
          resourceGroupName: nekoc  # Update this (e.g., hugecat-dns-rg)
          hostedZoneName: hugecat.net
          # Option 1: Use Managed Identity (recommended for AKS)
          managedIdentity:
            clientID: e502213f-1f15-4f03-9fb4-b546f51aafe9  # Update this
          # Option 2: Use Service Principal (alternative)
          # tenantID: YOUR_TENANT_ID
          # clientID: YOUR_CLIENT_ID
          # clientSecretSecretRef:
          #   name: azuredns-config
          #   key: client-secret
    # HTTP-01 challenge as fallback
    - http01:
        ingress:
          class: istio
